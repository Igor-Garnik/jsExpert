(function () {
'use strict';

class Utils {
    constructor() {}

    static initTemplate(wrapper, template) {
        var clon = template.content.cloneNode(true);
        wrapper.innerHTML = '';
        wrapper.appendChild(clon);
    }

    static setActiveLink(elem, object) {
        object.forEach(item => {
            if (item == elem) {
                item.classList.add("active");
            } else {
                item.classList.remove("active");
            }
        });
    }

    static navigateTo(routeName) {
        window.location.hash = "#" + routeName;
    }

    static isLoggedIn() {
        let credentials = JSON.parse(localStorage.getItem('credentials'));
        return !!credentials;
    }
}

class LoginView {
    constructor() {
        this.domElements = {
            logInBtn: document.querySelector("#log-in-btn"),
            logOutBtn: document.querySelector("#log-out-btn"),

            logIn: document.querySelector("#inputEmail"),
            password: document.querySelector("#inputPassword")
        };
        this.linksElement = {
            home: document.querySelector(".home-state"),
            gallery: document.querySelector(".gallery-state"),
            profile: document.querySelector(".profile-state")
        };
    }

    showMsg(msg) {
        if (msg) {
            this.domElements.alert.classList.remove("hide");
            this.domElements.alert.innerHTML = msg;
        }
    }

    hideMsg() {
        this.domElements.alert.classList.add("hide");
    }

    showLinks() {
        this.linksElements.forEach(item => item.classList.remove("hide"));
    }

    hideLinks() {
        his.linksElements.forEach(item => item.classList.add("hide"));
    }

    getCredentials() {
        return {
            login: this.DOMElements.login.value,
            password: this.DOMElements.password.value
        };
    }
}

let wraper = document.querySelector("#wrapper");
let login = document.querySelector("#login-view");
let home = document.querySelector("#home-view");
let gallery = document.querySelector("#gallery-view");
let profile = document.querySelector("#profile-view");
let navBar = document.querySelector("#navbarResponsive");

let routeConfig = {
    "": () => {
        Utils.initTemplate(wrapper, login);
        let view = new LoginView();
    },
    "home": () => {
        Utils.initTemplate(wrapper, home);
    },
    "gallery": () => {
        Utils.initTemplate(wrapper, gallery);
    },
    "profile": () => {
        Utils.initTemplate(wrapper, profile);
    }
};

function activateRoute(routeName) {
    let route = routeConfig[routeName];
    route && route();
}

function updateRoute() {
    let routeName = document.location.hash.replace(/^#/, '');
    if (routeName) {
        Utils.navigateTo(routeName);
        activateRoute(routeName);
    } else {
        activateRoute(routeName);
    }
}

window.addEventListener('load', updateRoute);
window.addEventListener('hashchange', updateRoute);

}());

var router = (function (exports) {
'use strict';

class Utils {
    constructor() {}

    static initTemplate(wrapper, template) {
        var clon = template.content.cloneNode(true);
        wrapper.innerHTML = '';
        wrapper.appendChild(clon);
    }

    static setActiveLink(elem, object) {
        object.forEach(item => {
            if (item == elem) {
                item.classList.add("active");
            } else {
                item.classList.remove("active");
            }
        });
    }

    static navigateTo(routeName) {
        window.location.hash = "#" + routeName;
    }

    static isLoggedIn() {
        let credentials = JSON.parse(localStorage.getItem('credentials'));
        return !!credentials;
    }
}

class LoginView {
    constructor() {
        this.domElements = {
            logInBtn: document.querySelector("#log-in-btn"),
            logOutBtn: document.querySelector("#log-out-btn"),

            logIn: document.querySelector("#inputEmail"),
            password: document.querySelector("#inputPassword")
        };
        this.linksElement = {
            home: document.querySelector(".home-state"),
            gallery: document.querySelector(".gallery-state"),
            profile: document.querySelector(".profile-state")
        };
    }

    showMsg(msg) {
        if (msg) {
            this.domElements.alert.classList.remove("hide");
            this.domElements.alert.innerHTML = msg;
        }
    }

    hideMsg() {
        this.domElements.alert.classList.add("hide");
    }

    showLinks() {
        this.linksElements.forEach(item => item.classList.remove("hide"));
    }

    hideLinks() {
        his.linksElements.forEach(item => item.classList.add("hide"));
    }

    getCredentials() {
        return {
            login: this.DOMElements.login.value,
            password: this.DOMElements.password.value
        };
    }
}

let wraper = document.querySelector("#wrapper");
let login = document.querySelector("#login-view");
let home = document.querySelector("#home-view");
let gallery = document.querySelector("#gallery-view");
let profile = document.querySelector("#profile-view");
let navBar = document.querySelector("#navbarResponsive");

let routeConfig = {
    "": () => {
        Utils.initTemplate(wrapper, login);
        let view = new LoginView();
    },
    "home": () => {
        Utils.initTemplate(wrapper, home);
    },
    "gallery": () => {
        Utils.initTemplate(wrapper, gallery);
    },
    "profile": () => {
        Utils.initTemplate(wrapper, profile);
    }
};

function activateRoute(routeName) {
    let route = routeConfig[routeName];
    route && route();
}

function updateRoute() {
    let routeName = document.location.hash.replace(/^#/, '');
    if (routeName) {
        Utils.navigateTo(routeName);
        activateRoute(routeName);
    } else {
        activateRoute(routeName);
    }
}

exports.updateRoute = updateRoute;

return exports;

}({}));

var utils = (function () {
'use strict';

class Utils {
    constructor() {}

    static initTemplate(wrapper, template) {
        var clon = template.content.cloneNode(true);
        wrapper.innerHTML = '';
        wrapper.appendChild(clon);
    }

    static setActiveLink(elem, object) {
        object.forEach(item => {
            if (item == elem) {
                item.classList.add("active");
            } else {
                item.classList.remove("active");
            }
        });
    }

    static navigateTo(routeName) {
        window.location.hash = "#" + routeName;
    }

    static isLoggedIn() {
        let credentials = JSON.parse(localStorage.getItem('credentials'));
        return !!credentials;
    }
}

return Utils;

}());

var galleryController = (function () {
'use strict';

class GalleryController {
    controller(model, view, observer, utils) {
        this.model = model;
        this.view = view;
        this.observe = observer;
        this.utils = utils;
    }

}

return GalleryController;

}());

var galleryModel = (function () {
'use strict';

class GaleryModel {
    constructor() {
        this.url = "http://localhost:3000";
    }
    // getServerItem () {
    //     return fetch(this.url).then(response => response.json());
    //     .then(data => {
    //         console.log("Data loaded");
    //         return data
    //     })
    // }
}

return GaleryModel;

}());

var galleryView = (function () {
'use strict';

class GalleryView {
    constructor() {
        this.domElements = {};
    }
}

return GalleryView;

}());

var observer = (function () {
'use strict';

class Observer {
    constructor() {
        this.events = {};
    }

    subscribeEvent(name, func) {
        this.events[name] = func;
    }

    callEvent(name, arg) {
        if (this.events[name]) {
            this.events[name](arg);
        }
    }
}

return Observer;

}());

var homeController = (function () {
'use strict';

class HomeController {
    controller(model, view, observer, utils) {
        this.model = model;
        this.view = view;
        this.observe = observer;
        this.utils = utils;
    }
}

return HomeController;

}());

var homeModel = (function () {
'use strict';

class HomeModel {
    constructor() {
        this.url = "http://localhost:3000";
    }
    // getServerItem () {
    //     return fetch(this.url).then(response => response.json());
    //     .then(data => {
    //         console.log("Data loaded");
    //         return data
    //     })
    // }
}

return HomeModel;

}());

var homeView = (function () {
'use strict';

class HomeView {
    constructor() {
        this.domElements = {};
    }
}

return HomeView;

}());

var profileController = (function () {
'use strict';

class ProfileController {
    controller(model, view, observer, utils) {
        this.model = model;
        this.view = view;
        this.observe = observer;
        this.utils = utils;
    }
    bindEvents() {}
    fillInfoFields() {}
    init() {}
}

return ProfileController;

}());

var profileModel = (function () {
'use strict';

class GaleryModel {
    constructor() {
        this.url = "http://localhost:3000";
    }
    // getServerItem () {
    //     return fetch(this.url).then(response => response.json());
    //     .then(data => {
    //         console.log("Data loaded");
    //         return data
    //     })
    // }
}

return GaleryModel;

}());

var profileView = (function () {
'use strict';

class ProfileView {
    constructor() {
        this.domElements = {};
    }
}

return ProfileView;

}());

var loginController = (function () {
'use strict';

class LoginController {
    controller(model, view, observer, utils) {
        this.model = model;
        this.view = view;
        this.observe = observer;
        this.utils = utils;
    }

    initListeners() {
        this.view.domElements.logIn.addEventListeners("click", this.logInHandler.bind(this));
        this.view.domElements.logOut.addEventListeners("click", this.logOutHandler.bind(this));
        console.log("alert");
    }
    logInHandler(event) {

        event.preventDefault();
        console.log("hello");
        let credentials = this.view.getCradentials();
        if (this.model.validate(credentials)) {
            this.model.login(credentials).then(data => {
                if (data.loginStatus) {
                    this.view.hideMsg();
                    this.view.showLinks();
                    this.utils.navigateTo("gallery");
                } else {
                    this.view.showMsg(this.model.getErrorMsg());
                }
            });
        } else {
            this.view.showMsg(this.model.getErrorMsg());
        }
    }

    logoutHandler() {
        this.view.hideLinks();
        this.model.logout();
        this.utils.navigateTo("");
    }
}

return LoginController;

}());

var loginModel = (function () {
'use strict';

class LoginModel {
    constructor() {
        this.loginUrl = "http://localhost:3000/login";
        this.emailPattern = /^\w+@\w+\.\w{2,4}$/i;
        this.passwordPattern = /^[a-zA-Z0-9]{8,30}$/;
        this.errorMsg = null;
        this.errorMsgMap = {
            "empty": 'Пожалуйста заполните поля логин и пароль',
            "loginError": 'Логин введен неверно. Только латинские буквы.',
            "passError": 'Пароль введен неверно. Тольк латинские буквы, цифры. Длина не менее 8 символов',
            "missmatch": 'Неправильные логин или пароль.'
        };
    }

    validate(cradentials) {
        return isEmpty(cradentials) && isEmailAssertPattern(cradentials) && isPasswordAssertPattern(cradentials);
    }

    login(credentials) {
        let options = {
            headers: {
                'Content-type': 'application/json; charset=utf-8'
            },
            method: 'post',
            body: JSON.stringify(credentials)
        };
        return fetch(this.loginUrl, options).then(responce => responce.json()).then(data => {
            if (data.loginStatus) {
                localStorage.setItem('credentials', JSON.stringify(credentials));
            } else {
                this.setErrorMsg("missmatch");
            }
            return data;
        });
    }

    getErrorMsg() {
        return this.errorMsg;
    }

    setErrorMsg(key) {
        this.errorMsg = this.errorMsgMap[key];
        return false;
    }

    isEmpty(credentials) {
        return credentials.login && credentials.password || this.setErrorMsg("empty");
    }

    isEmailAssertPattern(credentials) {
        return this.emailPattern.test(credentials.login) || this.setErrorMsg("loginError");
    }

    isPasswordAssertPattern(credentials) {
        return this.passwordPattern.test(credentials.password) || this.setErrorMsg("passError");
    }

    logout() {
        localStorage.removeItem('credentials');
    }
}

return LoginModel;

}());

var loginView = (function () {
'use strict';

class LoginView {
    constructor() {
        this.domElements = {
            logInBtn: document.querySelector("#log-in-btn"),
            logOutBtn: document.querySelector("#log-out-btn"),

            logIn: document.querySelector("#inputEmail"),
            password: document.querySelector("#inputPassword")
        };
        this.linksElement = {
            home: document.querySelector(".home-state"),
            gallery: document.querySelector(".gallery-state"),
            profile: document.querySelector(".profile-state")
        };
    }

    showMsg(msg) {
        if (msg) {
            this.domElements.alert.classList.remove("hide");
            this.domElements.alert.innerHTML = msg;
        }
    }

    hideMsg() {
        this.domElements.alert.classList.add("hide");
    }

    showLinks() {
        this.linksElements.forEach(item => item.classList.remove("hide"));
    }

    hideLinks() {
        his.linksElements.forEach(item => item.classList.add("hide"));
    }

    getCredentials() {
        return {
            login: this.DOMElements.login.value,
            password: this.DOMElements.password.value
        };
    }
}

return LoginView;

}());

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIiwibG9naW4vbG9naW4udmlldy5qcyIsInJvdXRlci5qcyIsImFwcC5qcyIsImdhbGxlcnkuY29udHJvbGxlci5qcyIsImdhbGxlcnkubW9kZWwuanMiLCJnYWxsZXJ5LnZpZXcuanMiLCJvYnNlcnZlci5qcyIsImhvbWUuY29udHJvbGxlci5qcyIsImhvbWUubW9kZWwuanMiLCJob21lLnZpZXcuanMiLCJwcm9maWxlLmNvbnRyb2xsZXIuanMiLCJwcm9maWxlLm1vZGVsLmpzIiwicHJvZmlsZS52aWV3LmpzIiwibG9naW4uY29udHJvbGxlci5qcyIsImxvZ2luLm1vZGVsLmpzIiwibG9naW4udmlldy5qcyJdLCJuYW1lcyI6WyJVdGlscyIsImluaXRUZW1wbGF0ZSIsIndyYXBwZXIiLCJ0ZW1wbGF0ZSIsImNsb24iLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJzZXRBY3RpdmVMaW5rIiwiZWxlbSIsIm9iamVjdCIsImZvckVhY2giLCJpdGVtIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwibmF2aWdhdGVUbyIsInJvdXRlTmFtZSIsImxvY2F0aW9uIiwiaGFzaCIsImlzTG9nZ2VkSW4iLCJjcmVkZW50aWFscyIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJMb2dpblZpZXciLCJkb21FbGVtZW50cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImxpbmtzRWxlbWVudCIsIm1zZyIsImFsZXJ0IiwibGlua3NFbGVtZW50cyIsIkRPTUVsZW1lbnRzIiwibG9naW4iLCJ2YWx1ZSIsInBhc3N3b3JkIiwid3JhcGVyIiwiaG9tZSIsImdhbGxlcnkiLCJwcm9maWxlIiwibmF2QmFyIiwicm91dGVDb25maWciLCJ2aWV3IiwiYWN0aXZhdGVSb3V0ZSIsInJvdXRlIiwidXBkYXRlUm91dGUiLCJyZXBsYWNlIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIkdhbGxlcnlDb250cm9sbGVyIiwibW9kZWwiLCJvYnNlcnZlciIsInV0aWxzIiwib2JzZXJ2ZSIsIkdhbGVyeU1vZGVsIiwidXJsIiwiR2FsbGVyeVZpZXciLCJPYnNlcnZlciIsImV2ZW50cyIsIm5hbWUiLCJmdW5jIiwiYXJnIiwiSG9tZUNvbnRyb2xsZXIiLCJIb21lTW9kZWwiLCJIb21lVmlldyIsIlByb2ZpbGVDb250cm9sbGVyIiwiUHJvZmlsZVZpZXciLCJMb2dpbkNvbnRyb2xsZXIiLCJsb2dJbiIsImFkZEV2ZW50TGlzdGVuZXJzIiwibG9nSW5IYW5kbGVyIiwiYmluZCIsImxvZ091dCIsImxvZ091dEhhbmRsZXIiLCJsb2ciLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwiZ2V0Q3JhZGVudGlhbHMiLCJ2YWxpZGF0ZSIsInRoZW4iLCJkYXRhIiwibG9naW5TdGF0dXMiLCJoaWRlTXNnIiwic2hvd0xpbmtzIiwic2hvd01zZyIsImdldEVycm9yTXNnIiwiaGlkZUxpbmtzIiwibG9nb3V0IiwiTG9naW5Nb2RlbCIsImxvZ2luVXJsIiwiZW1haWxQYXR0ZXJuIiwicGFzc3dvcmRQYXR0ZXJuIiwiZXJyb3JNc2ciLCJlcnJvck1zZ01hcCIsImNyYWRlbnRpYWxzIiwiaXNFbXB0eSIsImlzRW1haWxBc3NlcnRQYXR0ZXJuIiwiaXNQYXNzd29yZEFzc2VydFBhdHRlcm4iLCJvcHRpb25zIiwic3RyaW5naWZ5IiwiZmV0Y2giLCJyZXNwb25jZSIsImpzb24iLCJzZXRJdGVtIiwic2V0RXJyb3JNc2ciLCJrZXkiLCJ0ZXN0IiwicmVtb3ZlSXRlbSJdLCJtYXBwaW5ncyI6Ijs7O0FBQWUsTUFBTUEsS0FBTixDQUFZO2tCQUNUOztXQUVQQyxZQUFQLENBQW9CQyxPQUFwQixFQUE2QkMsUUFBN0IsRUFBdUM7WUFDL0JDLE9BQU9ELFNBQVNFLE9BQVQsQ0FBaUJDLFNBQWpCLENBQTJCLElBQTNCLENBQVg7Z0JBQ1FDLFNBQVIsR0FBb0IsRUFBcEI7Z0JBQ1FDLFdBQVIsQ0FBb0JKLElBQXBCOzs7V0FHR0ssYUFBUCxDQUFxQkMsSUFBckIsRUFBMEJDLE1BQTFCLEVBQWtDO2VBQ3ZCQyxPQUFQLENBQWVDLFFBQVE7Z0JBQ2hCQSxRQUFRSCxJQUFYLEVBQWlCO3FCQUNSSSxTQUFMLENBQWVDLEdBQWYsQ0FBbUIsUUFBbkI7YUFESixNQUVPO3FCQUNFRCxTQUFMLENBQWVFLE1BQWYsQ0FBc0IsUUFBdEI7O1NBSlI7OztXQVNHQyxVQUFQLENBQWtCQyxTQUFsQixFQUE2QjtlQUNsQkMsUUFBUCxDQUFnQkMsSUFBaEIsR0FBc0IsTUFBTUYsU0FBNUI7OztXQUdHRyxVQUFQLEdBQW9CO1lBQ1pDLGNBQWNDLEtBQUtDLEtBQUwsQ0FBV0MsYUFBYUMsT0FBYixDQUFxQixhQUFyQixDQUFYLENBQWxCO2VBQ08sQ0FBQyxDQUFDSixXQUFUOzs7O0FDekJPLE1BQU1LLFNBQU4sQ0FBZ0I7a0JBQ1o7YUFDTkMsV0FBTCxHQUFtQjtzQkFDSkMsU0FBU0MsYUFBVCxDQUF1QixhQUF2QixDQURJO3VCQUVIRCxTQUFTQyxhQUFULENBQXVCLGNBQXZCLENBRkc7O21CQUlQRCxTQUFTQyxhQUFULENBQXVCLGFBQXZCLENBSk87c0JBS0pELFNBQVNDLGFBQVQsQ0FBdUIsZ0JBQXZCO1NBTGY7YUFPS0MsWUFBTCxHQUFvQjtrQkFDVEYsU0FBU0MsYUFBVCxDQUF1QixhQUF2QixDQURTO3FCQUVORCxTQUFTQyxhQUFULENBQXVCLGdCQUF2QixDQUZNO3FCQUdORCxTQUFTQyxhQUFULENBQXVCLGdCQUF2QjtTQUhkOzs7WUFPSUUsR0FBUixFQUFhO1lBQ0xBLEdBQUosRUFBUztpQkFDQUosV0FBTCxDQUFpQkssS0FBakIsQ0FBdUJuQixTQUF2QixDQUFpQ0UsTUFBakMsQ0FBd0MsTUFBeEM7aUJBQ0tZLFdBQUwsQ0FBaUJLLEtBQWpCLENBQXVCMUIsU0FBdkIsR0FBbUN5QixHQUFuQzs7OztjQUlFO2FBQ0RKLFdBQUwsQ0FBaUJLLEtBQWpCLENBQXVCbkIsU0FBdkIsQ0FBaUNDLEdBQWpDLENBQXFDLE1BQXJDOzs7Z0JBR1E7YUFDSG1CLGFBQUwsQ0FBbUJ0QixPQUFuQixDQUEyQkMsUUFBUUEsS0FBS0MsU0FBTCxDQUFlRSxNQUFmLENBQXNCLE1BQXRCLENBQW5DOzs7Z0JBR1E7WUFDSmtCLGFBQUosQ0FBa0J0QixPQUFsQixDQUEwQkMsUUFBUUEsS0FBS0MsU0FBTCxDQUFlQyxHQUFmLENBQW1CLE1BQW5CLENBQWxDOzs7cUJBR2E7ZUFDTjttQkFDSSxLQUFLb0IsV0FBTCxDQUFpQkMsS0FBakIsQ0FBdUJDLEtBRDNCO3NCQUVPLEtBQUtGLFdBQUwsQ0FBaUJHLFFBQWpCLENBQTBCRDtTQUZ4Qzs7OztBQ2pCUixJQUFJRSxTQUFTVixTQUFTQyxhQUFULENBQXVCLFVBQXZCLENBQWI7QUFDQSxJQUFJTSxRQUFRUCxTQUFTQyxhQUFULENBQXVCLGFBQXZCLENBQVo7QUFDQSxJQUFJVSxPQUFPWCxTQUFTQyxhQUFULENBQXVCLFlBQXZCLENBQVg7QUFDQSxJQUFJVyxVQUFVWixTQUFTQyxhQUFULENBQXVCLGVBQXZCLENBQWQ7QUFDQSxJQUFJWSxVQUFVYixTQUFTQyxhQUFULENBQXVCLGVBQXZCLENBQWQ7QUFDQSxJQUFJYSxTQUFTZCxTQUFTQyxhQUFULENBQXVCLG1CQUF2QixDQUFiO0FBQ0E7QUFFQSxJQUFJYyxjQUFjO1FBQ1QsTUFBTTtjQUNEM0MsWUFBTixDQUFtQkMsT0FBbkIsRUFBNEJrQyxLQUE1QjtBQUNBLEFBQ0EsWUFBSVMsT0FBTyxJQUFJbEIsU0FBSixFQUFYO0FBQ0EsQUFDSCxLQU5hO1lBT0wsTUFBTTtjQUNMMUIsWUFBTixDQUFtQkMsT0FBbkIsRUFBNEJzQyxJQUE1QjtBQUNBLEFBR0gsS0FaYTtlQWFGLE1BQU07Y0FDUnZDLFlBQU4sQ0FBbUJDLE9BQW5CLEVBQTRCdUMsT0FBNUI7QUFDQSxBQUlILEtBbkJhO2VBb0JGLE1BQU07Y0FDUnhDLFlBQU4sQ0FBbUJDLE9BQW5CLEVBQTRCd0MsT0FBNUI7QUFDQSxBQUdIO0NBekJMOztBQTRCQSxTQUFTSSxhQUFULENBQXVCNUIsU0FBdkIsRUFBaUM7UUFDekI2QixRQUFRSCxZQUFZMUIsU0FBWixDQUFaO2FBQ1M2QixPQUFUOzs7QUFHSixBQUFPLFNBQVNDLFdBQVQsR0FBdUI7UUFDdEI5QixZQUFZVyxTQUFTVixRQUFULENBQWtCQyxJQUFsQixDQUF1QjZCLE9BQXZCLENBQStCLElBQS9CLEVBQXFDLEVBQXJDLENBQWhCO1FBQ0cvQixTQUFILEVBQWM7Y0FDSkQsVUFBTixDQUFpQkMsU0FBakI7c0JBQ2NBLFNBQWQ7S0FGSixNQUdPO3NCQUNXQSxTQUFkOzs7O0FDaEVSZ0MsT0FBT0MsZ0JBQVAsQ0FBd0IsTUFBeEIsRUFBZ0NILFdBQWhDO0FBQ0FFLE9BQU9DLGdCQUFQLENBQXdCLFlBQXhCLEVBQXNDSCxXQUF0Qzs7Ozs7OztBSEhlLE1BQU1oRCxLQUFOLENBQVk7a0JBQ1Q7O1dBRVBDLFlBQVAsQ0FBb0JDLE9BQXBCLEVBQTZCQyxRQUE3QixFQUF1QztZQUMvQkMsT0FBT0QsU0FBU0UsT0FBVCxDQUFpQkMsU0FBakIsQ0FBMkIsSUFBM0IsQ0FBWDtnQkFDUUMsU0FBUixHQUFvQixFQUFwQjtnQkFDUUMsV0FBUixDQUFvQkosSUFBcEI7OztXQUdHSyxhQUFQLENBQXFCQyxJQUFyQixFQUEwQkMsTUFBMUIsRUFBa0M7ZUFDdkJDLE9BQVAsQ0FBZUMsUUFBUTtnQkFDaEJBLFFBQVFILElBQVgsRUFBaUI7cUJBQ1JJLFNBQUwsQ0FBZUMsR0FBZixDQUFtQixRQUFuQjthQURKLE1BRU87cUJBQ0VELFNBQUwsQ0FBZUUsTUFBZixDQUFzQixRQUF0Qjs7U0FKUjs7O1dBU0dDLFVBQVAsQ0FBa0JDLFNBQWxCLEVBQTZCO2VBQ2xCQyxRQUFQLENBQWdCQyxJQUFoQixHQUFzQixNQUFNRixTQUE1Qjs7O1dBR0dHLFVBQVAsR0FBb0I7WUFDWkMsY0FBY0MsS0FBS0MsS0FBTCxDQUFXQyxhQUFhQyxPQUFiLENBQXFCLGFBQXJCLENBQVgsQ0FBbEI7ZUFDTyxDQUFDLENBQUNKLFdBQVQ7Ozs7QUN6Qk8sTUFBTUssU0FBTixDQUFnQjtrQkFDWjthQUNOQyxXQUFMLEdBQW1CO3NCQUNKQyxTQUFTQyxhQUFULENBQXVCLGFBQXZCLENBREk7dUJBRUhELFNBQVNDLGFBQVQsQ0FBdUIsY0FBdkIsQ0FGRzs7bUJBSVBELFNBQVNDLGFBQVQsQ0FBdUIsYUFBdkIsQ0FKTztzQkFLSkQsU0FBU0MsYUFBVCxDQUF1QixnQkFBdkI7U0FMZjthQU9LQyxZQUFMLEdBQW9CO2tCQUNURixTQUFTQyxhQUFULENBQXVCLGFBQXZCLENBRFM7cUJBRU5ELFNBQVNDLGFBQVQsQ0FBdUIsZ0JBQXZCLENBRk07cUJBR05ELFNBQVNDLGFBQVQsQ0FBdUIsZ0JBQXZCO1NBSGQ7OztZQU9JRSxHQUFSLEVBQWE7WUFDTEEsR0FBSixFQUFTO2lCQUNBSixXQUFMLENBQWlCSyxLQUFqQixDQUF1Qm5CLFNBQXZCLENBQWlDRSxNQUFqQyxDQUF3QyxNQUF4QztpQkFDS1ksV0FBTCxDQUFpQkssS0FBakIsQ0FBdUIxQixTQUF2QixHQUFtQ3lCLEdBQW5DOzs7O2NBSUU7YUFDREosV0FBTCxDQUFpQkssS0FBakIsQ0FBdUJuQixTQUF2QixDQUFpQ0MsR0FBakMsQ0FBcUMsTUFBckM7OztnQkFHUTthQUNIbUIsYUFBTCxDQUFtQnRCLE9BQW5CLENBQTJCQyxRQUFRQSxLQUFLQyxTQUFMLENBQWVFLE1BQWYsQ0FBc0IsTUFBdEIsQ0FBbkM7OztnQkFHUTtZQUNKa0IsYUFBSixDQUFrQnRCLE9BQWxCLENBQTBCQyxRQUFRQSxLQUFLQyxTQUFMLENBQWVDLEdBQWYsQ0FBbUIsTUFBbkIsQ0FBbEM7OztxQkFHYTtlQUNOO21CQUNJLEtBQUtvQixXQUFMLENBQWlCQyxLQUFqQixDQUF1QkMsS0FEM0I7c0JBRU8sS0FBS0YsV0FBTCxDQUFpQkcsUUFBakIsQ0FBMEJEO1NBRnhDOzs7O0FDakJSLElBQUlFLFNBQVNWLFNBQVNDLGFBQVQsQ0FBdUIsVUFBdkIsQ0FBYjtBQUNBLElBQUlNLFFBQVFQLFNBQVNDLGFBQVQsQ0FBdUIsYUFBdkIsQ0FBWjtBQUNBLElBQUlVLE9BQU9YLFNBQVNDLGFBQVQsQ0FBdUIsWUFBdkIsQ0FBWDtBQUNBLElBQUlXLFVBQVVaLFNBQVNDLGFBQVQsQ0FBdUIsZUFBdkIsQ0FBZDtBQUNBLElBQUlZLFVBQVViLFNBQVNDLGFBQVQsQ0FBdUIsZUFBdkIsQ0FBZDtBQUNBLElBQUlhLFNBQVNkLFNBQVNDLGFBQVQsQ0FBdUIsbUJBQXZCLENBQWI7QUFDQTtBQUVBLElBQUljLGNBQWM7UUFDVCxNQUFNO2NBQ0QzQyxZQUFOLENBQW1CQyxPQUFuQixFQUE0QmtDLEtBQTVCO0FBQ0EsQUFDQSxZQUFJUyxPQUFPLElBQUlsQixTQUFKLEVBQVg7QUFDQSxBQUNILEtBTmE7WUFPTCxNQUFNO2NBQ0wxQixZQUFOLENBQW1CQyxPQUFuQixFQUE0QnNDLElBQTVCO0FBQ0EsQUFHSCxLQVphO2VBYUYsTUFBTTtjQUNSdkMsWUFBTixDQUFtQkMsT0FBbkIsRUFBNEJ1QyxPQUE1QjtBQUNBLEFBSUgsS0FuQmE7ZUFvQkYsTUFBTTtjQUNSeEMsWUFBTixDQUFtQkMsT0FBbkIsRUFBNEJ3QyxPQUE1QjtBQUNBLEFBR0g7Q0F6Qkw7O0FBNEJBLFNBQVNJLGFBQVQsQ0FBdUI1QixTQUF2QixFQUFpQztRQUN6QjZCLFFBQVFILFlBQVkxQixTQUFaLENBQVo7YUFDUzZCLE9BQVQ7OztBQUdKLEFBQU8sU0FBU0MsV0FBVCxHQUF1QjtRQUN0QjlCLFlBQVlXLFNBQVNWLFFBQVQsQ0FBa0JDLElBQWxCLENBQXVCNkIsT0FBdkIsQ0FBK0IsSUFBL0IsRUFBcUMsRUFBckMsQ0FBaEI7UUFDRy9CLFNBQUgsRUFBYztjQUNKRCxVQUFOLENBQWlCQyxTQUFqQjtzQkFDY0EsU0FBZDtLQUZKLE1BR087c0JBQ1dBLFNBQWQ7Ozs7Ozs7Ozs7Ozs7QUZsRU8sTUFBTWxCLEtBQU4sQ0FBWTtrQkFDVDs7V0FFUEMsWUFBUCxDQUFvQkMsT0FBcEIsRUFBNkJDLFFBQTdCLEVBQXVDO1lBQy9CQyxPQUFPRCxTQUFTRSxPQUFULENBQWlCQyxTQUFqQixDQUEyQixJQUEzQixDQUFYO2dCQUNRQyxTQUFSLEdBQW9CLEVBQXBCO2dCQUNRQyxXQUFSLENBQW9CSixJQUFwQjs7O1dBR0dLLGFBQVAsQ0FBcUJDLElBQXJCLEVBQTBCQyxNQUExQixFQUFrQztlQUN2QkMsT0FBUCxDQUFlQyxRQUFRO2dCQUNoQkEsUUFBUUgsSUFBWCxFQUFpQjtxQkFDUkksU0FBTCxDQUFlQyxHQUFmLENBQW1CLFFBQW5CO2FBREosTUFFTztxQkFDRUQsU0FBTCxDQUFlRSxNQUFmLENBQXNCLFFBQXRCOztTQUpSOzs7V0FTR0MsVUFBUCxDQUFrQkMsU0FBbEIsRUFBNkI7ZUFDbEJDLFFBQVAsQ0FBZ0JDLElBQWhCLEdBQXNCLE1BQU1GLFNBQTVCOzs7V0FHR0csVUFBUCxHQUFvQjtZQUNaQyxjQUFjQyxLQUFLQyxLQUFMLENBQVdDLGFBQWFDLE9BQWIsQ0FBcUIsYUFBckIsQ0FBWCxDQUFsQjtlQUNPLENBQUMsQ0FBQ0osV0FBVDs7Ozs7Ozs7Ozs7QUl6Qk8sTUFBTThCLGlCQUFOLENBQXdCO2VBQ3ZCQyxLQUFaLEVBQW1CUixJQUFuQixFQUF5QlMsUUFBekIsRUFBbUNDLEtBQW5DLEVBQXlDO2FBQ2hDRixLQUFMLEdBQWFBLEtBQWI7YUFDS1IsSUFBTCxHQUFZQSxJQUFaO2FBQ0tXLE9BQUwsR0FBZUYsUUFBZjthQUNLQyxLQUFMLEdBQWFBLEtBQWI7Ozs7Ozs7Ozs7OztBQ0xPLE1BQU1FLFdBQU4sQ0FBa0I7a0JBQ2Q7YUFDTkMsR0FBTCxHQUFXLHVCQUFYOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNGTyxNQUFNQyxXQUFOLENBQWtCO2tCQUNkO2FBQ04vQixXQUFMLEdBQW1CLEVBQW5COzs7Ozs7Ozs7OztBQ0ZPLE1BQU1nQyxRQUFOLENBQWU7a0JBQ1o7YUFDTEMsTUFBTCxHQUFjLEVBQWQ7OzttQkFHV0MsSUFBZixFQUFxQkMsSUFBckIsRUFBMkI7YUFDbEJGLE1BQUwsQ0FBWUMsSUFBWixJQUFvQkMsSUFBcEI7OztjQUdNRCxJQUFWLEVBQWdCRSxHQUFoQixFQUFxQjtZQUNiLEtBQUtILE1BQUwsQ0FBWUMsSUFBWixDQUFKLEVBQXVCO2lCQUNkRCxNQUFMLENBQVlDLElBQVosRUFBa0JFLEdBQWxCOzs7Ozs7Ozs7Ozs7QUNYRyxNQUFNQyxjQUFOLENBQXFCO2VBQ3BCWixLQUFaLEVBQW1CUixJQUFuQixFQUF5QlMsUUFBekIsRUFBbUNDLEtBQW5DLEVBQXlDO2FBQ2hDRixLQUFMLEdBQWFBLEtBQWI7YUFDS1IsSUFBTCxHQUFZQSxJQUFaO2FBQ0tXLE9BQUwsR0FBZUYsUUFBZjthQUNLQyxLQUFMLEdBQWFBLEtBQWI7Ozs7Ozs7Ozs7O0FDTE8sTUFBTVcsU0FBTixDQUFnQjtrQkFDWjthQUNOUixHQUFMLEdBQVcsdUJBQVg7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ0ZPLE1BQU1TLFFBQU4sQ0FBZTtrQkFDWDthQUNOdkMsV0FBTCxHQUFtQixFQUFuQjs7Ozs7Ozs7Ozs7QUNGTyxNQUFNd0MsaUJBQU4sQ0FBd0I7ZUFDdkJmLEtBQVosRUFBbUJSLElBQW5CLEVBQXlCUyxRQUF6QixFQUFtQ0MsS0FBbkMsRUFBeUM7YUFDaENGLEtBQUwsR0FBYUEsS0FBYjthQUNLUixJQUFMLEdBQVlBLElBQVo7YUFDS1csT0FBTCxHQUFlRixRQUFmO2FBQ0tDLEtBQUwsR0FBYUEsS0FBYjs7aUJBRVM7cUJBQ0k7V0FDVjs7Ozs7Ozs7OztBQ1RJLE1BQU1FLFdBQU4sQ0FBa0I7a0JBQ2Q7YUFDTkMsR0FBTCxHQUFXLHVCQUFYOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNGTyxNQUFNVyxXQUFOLENBQWtCO2tCQUNkO2FBQ056QyxXQUFMLEdBQW1CLEVBQW5COzs7Ozs7Ozs7OztBQ0ZPLE1BQU0wQyxlQUFOLENBQXNCO2VBQ3JCakIsS0FBWixFQUFtQlIsSUFBbkIsRUFBeUJTLFFBQXpCLEVBQW1DQyxLQUFuQyxFQUEwQzthQUNqQ0YsS0FBTCxHQUFhQSxLQUFiO2FBQ0tSLElBQUwsR0FBWUEsSUFBWjthQUNLVyxPQUFMLEdBQWVGLFFBQWY7YUFDS0MsS0FBTCxHQUFhQSxLQUFiOzs7b0JBR1k7YUFDUFYsSUFBTCxDQUFVakIsV0FBVixDQUFzQjJDLEtBQXRCLENBQTRCQyxpQkFBNUIsQ0FBOEMsT0FBOUMsRUFBdUQsS0FBS0MsWUFBTCxDQUFrQkMsSUFBbEIsQ0FBdUIsSUFBdkIsQ0FBdkQ7YUFDSzdCLElBQUwsQ0FBVWpCLFdBQVYsQ0FBc0IrQyxNQUF0QixDQUE2QkgsaUJBQTdCLENBQStDLE9BQS9DLEVBQXdELEtBQUtJLGFBQUwsQ0FBbUJGLElBQW5CLENBQXdCLElBQXhCLENBQXhEO2dCQUNRRyxHQUFSLENBQVksT0FBWjs7aUJBRVNDLEtBQWIsRUFBb0I7O2NBRVZDLGNBQU47Z0JBQ2FGLEdBQVIsQ0FBWSxPQUFaO1lBQ0R2RCxjQUFjLEtBQUt1QixJQUFMLENBQVVtQyxjQUFWLEVBQWxCO1lBQ0ksS0FBSzNCLEtBQUwsQ0FBVzRCLFFBQVgsQ0FBb0IzRCxXQUFwQixDQUFKLEVBQXNDO2lCQUM3QitCLEtBQUwsQ0FBV2pCLEtBQVgsQ0FBaUJkLFdBQWpCLEVBQThCNEQsSUFBOUIsQ0FDSUMsUUFBUTtvQkFDQUEsS0FBS0MsV0FBVCxFQUFxQjt5QkFDWnZDLElBQUwsQ0FBVXdDLE9BQVY7eUJBQ0t4QyxJQUFMLENBQVV5QyxTQUFWO3lCQUNLL0IsS0FBTCxDQUFXdEMsVUFBWCxDQUFzQixTQUF0QjtpQkFISixNQUlPO3lCQUNFNEIsSUFBTCxDQUFVMEMsT0FBVixDQUFrQixLQUFLbEMsS0FBTCxDQUFXbUMsV0FBWCxFQUFsQjs7YUFQWjtTQURKLE1BWU87aUJBQ0UzQyxJQUFMLENBQVUwQyxPQUFWLENBQWtCLEtBQUtsQyxLQUFMLENBQVdtQyxXQUFYLEVBQWxCOzs7O29CQUlRO2FBQ1AzQyxJQUFMLENBQVU0QyxTQUFWO2FBQ0twQyxLQUFMLENBQVdxQyxNQUFYO2FBQ0tuQyxLQUFMLENBQVd0QyxVQUFYLENBQXNCLEVBQXRCOzs7Ozs7Ozs7OztBQ3RDTyxNQUFNMEUsVUFBTixDQUFpQjtrQkFDYjthQUNOQyxRQUFMLEdBQWdCLDZCQUFoQjthQUNLQyxZQUFMLEdBQW9CLHFCQUFwQjthQUNLQyxlQUFMLEdBQXVCLHFCQUF2QjthQUNLQyxRQUFMLEdBQWdCLElBQWhCO2FBQ0tDLFdBQUwsR0FBbUI7cUJBQ0QsMENBREM7MEJBRUQsK0NBRkM7eUJBR0QsZ0ZBSEM7eUJBSUQ7U0FKbEI7OzthQVFLQyxXQUFULEVBQXNCO2VBQ1hDLFFBQVFELFdBQVIsS0FDQUUscUJBQXFCRixXQUFyQixDQURBLElBRUFHLHdCQUF3QkgsV0FBeEIsQ0FGUDs7O1VBS0UzRSxXQUFOLEVBQW1CO1lBQ1grRSxVQUFVO3FCQUNEO2dDQUNXO2FBRlY7b0JBSUYsTUFKRTtrQkFLSjlFLEtBQUsrRSxTQUFMLENBQWVoRixXQUFmO1NBTFY7ZUFPT2lGLE1BQU0sS0FBS1gsUUFBWCxFQUFxQlMsT0FBckIsRUFDRm5CLElBREUsQ0FDR3NCLFlBQVlBLFNBQVNDLElBQVQsRUFEZixFQUVGdkIsSUFGRSxDQUVHQyxRQUFRO2dCQUNOQSxLQUFLQyxXQUFULEVBQXNCOzZCQUNMc0IsT0FBYixDQUFxQixhQUFyQixFQUFvQ25GLEtBQUsrRSxTQUFMLENBQWVoRixXQUFmLENBQXBDO2FBREosTUFFTztxQkFDRXFGLFdBQUwsQ0FBaUIsV0FBakI7O21CQUVHeEIsSUFBUDtTQVJELENBQVA7OztrQkFZVTtlQUNILEtBQUtZLFFBQVo7OztnQkFHUWEsR0FBWixFQUFnQjthQUNQYixRQUFMLEdBQWdCLEtBQUtDLFdBQUwsQ0FBaUJZLEdBQWpCLENBQWhCO2VBQ08sS0FBUDs7O1lBR0l0RixXQUFSLEVBQXFCO2VBQ1RBLFlBQVljLEtBQVosSUFBcUJkLFlBQVlnQixRQUFsQyxJQUErQyxLQUFLcUUsV0FBTCxDQUFpQixPQUFqQixDQUF0RDs7O3lCQUdpQnJGLFdBQXJCLEVBQWtDO2VBQ3ZCLEtBQUt1RSxZQUFMLENBQWtCZ0IsSUFBbEIsQ0FBdUJ2RixZQUFZYyxLQUFuQyxLQUE2QyxLQUFLdUUsV0FBTCxDQUFpQixZQUFqQixDQUFwRDs7OzRCQUdvQnJGLFdBQXhCLEVBQXFDO2VBQzFCLEtBQUt3RSxlQUFMLENBQXFCZSxJQUFyQixDQUEwQnZGLFlBQVlnQixRQUF0QyxLQUFtRCxLQUFLcUUsV0FBTCxDQUFpQixXQUFqQixDQUExRDs7O2FBR0k7cUJBQ1NHLFVBQWIsQ0FBd0IsYUFBeEI7Ozs7Ozs7Ozs7O0FDOURPLE1BQU1uRixTQUFOLENBQWdCO2tCQUNaO2FBQ05DLFdBQUwsR0FBbUI7c0JBQ0pDLFNBQVNDLGFBQVQsQ0FBdUIsYUFBdkIsQ0FESTt1QkFFSEQsU0FBU0MsYUFBVCxDQUF1QixjQUF2QixDQUZHOzttQkFJUEQsU0FBU0MsYUFBVCxDQUF1QixhQUF2QixDQUpPO3NCQUtKRCxTQUFTQyxhQUFULENBQXVCLGdCQUF2QjtTQUxmO2FBT0tDLFlBQUwsR0FBb0I7a0JBQ1RGLFNBQVNDLGFBQVQsQ0FBdUIsYUFBdkIsQ0FEUztxQkFFTkQsU0FBU0MsYUFBVCxDQUF1QixnQkFBdkIsQ0FGTTtxQkFHTkQsU0FBU0MsYUFBVCxDQUF1QixnQkFBdkI7U0FIZDs7O1lBT0lFLEdBQVIsRUFBYTtZQUNMQSxHQUFKLEVBQVM7aUJBQ0FKLFdBQUwsQ0FBaUJLLEtBQWpCLENBQXVCbkIsU0FBdkIsQ0FBaUNFLE1BQWpDLENBQXdDLE1BQXhDO2lCQUNLWSxXQUFMLENBQWlCSyxLQUFqQixDQUF1QjFCLFNBQXZCLEdBQW1DeUIsR0FBbkM7Ozs7Y0FJRTthQUNESixXQUFMLENBQWlCSyxLQUFqQixDQUF1Qm5CLFNBQXZCLENBQWlDQyxHQUFqQyxDQUFxQyxNQUFyQzs7O2dCQUdRO2FBQ0htQixhQUFMLENBQW1CdEIsT0FBbkIsQ0FBMkJDLFFBQVFBLEtBQUtDLFNBQUwsQ0FBZUUsTUFBZixDQUFzQixNQUF0QixDQUFuQzs7O2dCQUdRO1lBQ0prQixhQUFKLENBQWtCdEIsT0FBbEIsQ0FBMEJDLFFBQVFBLEtBQUtDLFNBQUwsQ0FBZUMsR0FBZixDQUFtQixNQUFuQixDQUFsQzs7O3FCQUdhO2VBQ047bUJBQ0ksS0FBS29CLFdBQUwsQ0FBaUJDLEtBQWpCLENBQXVCQyxLQUQzQjtzQkFFTyxLQUFLRixXQUFMLENBQWlCRyxRQUFqQixDQUEwQkQ7U0FGeEMiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFV0aWxzIHtcbiAgICBjb25zdHJ1Y3RvciAoKXt9XG5cbiAgICBzdGF0aWMgaW5pdFRlbXBsYXRlKHdyYXBwZXIsIHRlbXBsYXRlKSB7XG4gICAgICAgIHZhciBjbG9uID0gdGVtcGxhdGUuY29udGVudC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIHdyYXBwZXIuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoY2xvbik7XG4gICAgfVxuXG4gICAgc3RhdGljIHNldEFjdGl2ZUxpbmsoZWxlbSxvYmplY3QpIHtcbiAgICAgICAgb2JqZWN0LmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgICBpZihpdGVtID09IGVsZW0pIHtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBzdGF0aWMgbmF2aWdhdGVUbyhyb3V0ZU5hbWUpIHtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2g9IFwiI1wiICsgcm91dGVOYW1lO1xuICAgIH1cblxuICAgIHN0YXRpYyBpc0xvZ2dlZEluKCkge1xuICAgICAgICBsZXQgY3JlZGVudGlhbHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjcmVkZW50aWFscycpKTtcbiAgICAgICAgcmV0dXJuICEhY3JlZGVudGlhbHM7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTG9naW5WaWV3IHtcbiAgICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgICAgIHRoaXMuZG9tRWxlbWVudHMgPSB7XG4gICAgICAgICAgICBsb2dJbkJ0biA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbG9nLWluLWJ0blwiKSxcbiAgICAgICAgICAgIGxvZ091dEJ0biA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbG9nLW91dC1idG5cIiksXG5cbiAgICAgICAgICAgIGxvZ0luIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbnB1dEVtYWlsXCIpLFxuICAgICAgICAgICAgcGFzc3dvcmQgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2lucHV0UGFzc3dvcmRcIilcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5saW5rc0VsZW1lbnQgPSB7XG4gICAgICAgICAgICBob21lIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ob21lLXN0YXRlXCIpLFxuICAgICAgICAgICAgZ2FsbGVyeSA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeS1zdGF0ZVwiKSxcbiAgICAgICAgICAgIHByb2ZpbGUgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGUtc3RhdGVcIilcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzaG93TXNnKG1zZykge1xuICAgICAgICBpZiAobXNnKSB7XG4gICAgICAgICAgICB0aGlzLmRvbUVsZW1lbnRzLmFsZXJ0LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICAgICAgdGhpcy5kb21FbGVtZW50cy5hbGVydC5pbm5lckhUTUwgPSBtc2c7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoaWRlTXNnKCkge1xuICAgICAgICB0aGlzLmRvbUVsZW1lbnRzLmFsZXJ0LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgIH1cblxuICAgIHNob3dMaW5rcygpIHtcbiAgICAgICAgdGhpcy5saW5rc0VsZW1lbnRzLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpKTtcbiAgICB9XG5cbiAgICBoaWRlTGlua3MoKSB7XG4gICAgICAgIGhpcy5saW5rc0VsZW1lbnRzLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpKTtcbiAgICB9XG5cbiAgICBnZXRDcmVkZW50aWFscygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvZ2luOiB0aGlzLkRPTUVsZW1lbnRzLmxvZ2luLnZhbHVlLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuRE9NRWxlbWVudHMucGFzc3dvcmQudmFsdWVcbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQgdXRpbHMgZnJvbSBcIi4vdXRpbHMuanNcIjtcblxuaW1wb3J0IExvZ2luQ29udHJvbGxlciBmcm9tIFwiLi9sb2dpbi9sb2dpbi5jb250cm9sbGVyLmpzXCI7XG5pbXBvcnQgTG9naW5Nb2RlbCBmcm9tIFwiLi9sb2dpbi9sb2dpbi5tb2RlbC5qc1wiO1xuaW1wb3J0IExvZ2luVmlldyBmcm9tIFwiLi9sb2dpbi9sb2dpbi52aWV3LmpzXCI7XG5cbmltcG9ydCBHYWxsZXJ5Q29udHJvbGxlciBmcm9tIFwiLi9nYWxsZXJ5L2dhbGxlcnkuY29udHJvbGxlci5qc1wiO1xuaW1wb3J0IEdhbGxlcnlNb2RlbCBmcm9tIFwiLi9nYWxsZXJ5L2dhbGxlcnkubW9kZWwuanNcIjtcbmltcG9ydCBHYWxsZXJ5VmlldyBmcm9tIFwiLi9nYWxsZXJ5L2dhbGxlcnkudmlldy5qc1wiO1xuaW1wb3J0IE9ic2VydmVyIGZyb20gXCIuL2dhbGxlcnkvb2JzZXJ2ZXIuanNcIjtcblxuaW1wb3J0IEhvbWVDb250cm9sbGVyIGZyb20gXCIuL2hvbWUvaG9tZS5jb250cm9sbGVyLmpzXCI7XG5pbXBvcnQgSG9tZU1vZGVsIGZyb20gXCIuL2hvbWUvaG9tZS5tb2RlbC5qc1wiO1xuaW1wb3J0IEhvbWVWaWV3IGZyb20gXCIuL2hvbWUvaG9tZS52aWV3LmpzXCI7XG5cbmltcG9ydCBQcm9maWxlQ29udHJvbGxlciBmcm9tIFwiLi9wcm9maWxlL3Byb2ZpbGUuY29udHJvbGxlci5qc1wiO1xuaW1wb3J0IFByb2ZpbGVNb2RlbCBmcm9tICcuL3Byb2ZpbGUvcHJvZmlsZS5tb2RlbC5qcyc7XG5pbXBvcnQgUHJvZmlsZVZpZXcgZnJvbSBcIi4vcHJvZmlsZS9wcm9maWxlLnZpZXcuanNcIjtcblxubGV0IHdyYXBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjd3JhcHBlclwiKTtcbmxldCBsb2dpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbG9naW4tdmlld1wiKTtcbmxldCBob21lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNob21lLXZpZXdcIik7XG5sZXQgZ2FsbGVyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZ2FsbGVyeS12aWV3XCIpO1xubGV0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdmlld1wiKTtcbmxldCBuYXZCYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25hdmJhclJlc3BvbnNpdmVcIik7XG5sZXQgYWN0aXZhdGVkUm91dGVzID0ge307XG5cbmxldCByb3V0ZUNvbmZpZyA9IHtcbiAgICBcIlwiIDogKCkgPT4ge1xuICAgICAgICB1dGlscy5pbml0VGVtcGxhdGUod3JhcHBlciwgbG9naW4pO1xuICAgICAgICBsZXQgbW9kZWwgPSBuZXcgTG9naW5Nb2RlbCgpO1xuICAgICAgICBsZXQgdmlldyA9IG5ldyBMb2dpblZpZXcoKTtcbiAgICAgICAgbGV0IGNvbnRyb2xsZXIgPSBuZXcgTG9naW5Db250cm9sbGVyKG1vZGVsLCB2aWV3LCB1dGlscyk7XG4gICAgfSwgXG4gICAgXCJob21lXCIgOiAoKSA9PiB7XG4gICAgICAgIHV0aWxzLmluaXRUZW1wbGF0ZSh3cmFwcGVyLCBob21lKTtcbiAgICAgICAgbGV0IG1vZGVsID0gbmV3IEhvbWVNb2RlbDtcbiAgICAgICAgbGV0IHZpZXcgPSBuZXcgSG9tZVZpZXc7XG4gICAgICAgIG5ldyBIb21lQ29udHJvbGxlcihtb2RlbCwgdmlldywgdXRpbHMpO1xuICAgIH0sXG4gICAgXCJnYWxsZXJ5XCIgOiAoKSA9PiB7XG4gICAgICAgIHV0aWxzLmluaXRUZW1wbGF0ZSh3cmFwcGVyLCBnYWxsZXJ5KTtcbiAgICAgICAgbGV0IG1vZGVsID0gbmV3IEdhbGxlcnlNb2RlbDtcbiAgICAgICAgbGV0IHZpZXcgPSBuZXcgR2FsbGVyeVZpZXc7XG4gICAgICAgIGxldCBvYnNlcnZlciA9IG5ldyBPYnNlcnZlcjtcbiAgICAgICAgbmV3IEdhbGxlcnlDb250cm9sbGVyKG1vZGVsLCB2aWV3LCBvYnNlcnZlciwgdXRpbHMpO1xuICAgIH0sXG4gICAgXCJwcm9maWxlXCIgOiAoKSA9PiB7XG4gICAgICAgIHV0aWxzLmluaXRUZW1wbGF0ZSh3cmFwcGVyLCBwcm9maWxlKTtcbiAgICAgICAgbGV0IG1vZGVsID0gbmV3IFByb2ZpbGVNb2RlbDtcbiAgICAgICAgbGV0IHZpZXcgPSBuZXcgUHJvZmlsZVZpZXc7XG4gICAgICAgIG5ldyBQcm9maWxlQ29udHJvbGxlcihtb2RlbCwgdmlldywgdXRpbHMpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gYWN0aXZhdGVSb3V0ZShyb3V0ZU5hbWUpe1xuICAgIGxldCByb3V0ZSA9IHJvdXRlQ29uZmlnW3JvdXRlTmFtZV07XG4gICAgcm91dGUgJiYgcm91dGUoKTsgICAgXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVSb3V0ZSgpIHtcbiAgICBsZXQgcm91dGVOYW1lID0gZG9jdW1lbnQubG9jYXRpb24uaGFzaC5yZXBsYWNlKC9eIy8sICcnKTtcbiAgICBpZihyb3V0ZU5hbWUpIHtcbiAgICAgICAgdXRpbHMubmF2aWdhdGVUbyhyb3V0ZU5hbWUpOyBcbiAgICAgICAgYWN0aXZhdGVSb3V0ZShyb3V0ZU5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGFjdGl2YXRlUm91dGUocm91dGVOYW1lKTtcbiAgICB9XG4gICAgXG59XG5cbiIsImltcG9ydCB7dXBkYXRlUm91dGV9IGZyb20gJy4vcm91dGVyLmpzJztcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCB1cGRhdGVSb3V0ZSk7XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIHVwZGF0ZVJvdXRlKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYWxsZXJ5Q29udHJvbGxlciB7ICAgXG4gICAgY29udHJvbGxlciAobW9kZWwsIHZpZXcsIG9ic2VydmVyLCB1dGlscyl7XG4gICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgdGhpcy5vYnNlcnZlID0gb2JzZXJ2ZXI7XG4gICAgICAgIHRoaXMudXRpbHMgPSB1dGlsc1xuICAgIH1cblxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEdhbGVyeU1vZGVsIHtcbiAgICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgICAgIHRoaXMudXJsID0gXCJodHRwOi8vbG9jYWxob3N0OjMwMDBcIjtcbiAgICB9XG4gICAgLy8gZ2V0U2VydmVySXRlbSAoKSB7XG4gICAgLy8gICAgIHJldHVybiBmZXRjaCh0aGlzLnVybCkudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpO1xuICAgIC8vICAgICAudGhlbihkYXRhID0+IHtcbiAgICAvLyAgICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YSBsb2FkZWRcIik7XG4gICAgLy8gICAgICAgICByZXR1cm4gZGF0YVxuICAgIC8vICAgICB9KVxuICAgIC8vIH1cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYWxsZXJ5VmlldyB7XG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgICB0aGlzLmRvbUVsZW1lbnRzID0ge1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgT2JzZXJ2ZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmV2ZW50cyA9IHt9O1xuICAgIH1cblxuICAgIHN1YnNjcmliZUV2ZW50KG5hbWUsIGZ1bmMpIHtcbiAgICAgICAgdGhpcy5ldmVudHNbbmFtZV0gPSBmdW5jO1xuICAgIH1cbiAgICBcbiAgICBjYWxsRXZlbnQobmFtZSwgYXJnKSB7XG4gICAgICAgIGlmICh0aGlzLmV2ZW50c1tuYW1lXSkge1xuICAgICAgICAgICAgdGhpcy5ldmVudHNbbmFtZV0oYXJnKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEhvbWVDb250cm9sbGVyIHsgICBcbiAgICBjb250cm9sbGVyIChtb2RlbCwgdmlldywgb2JzZXJ2ZXIsIHV0aWxzKXtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgICAgICB0aGlzLm9ic2VydmUgPSBvYnNlcnZlcjtcbiAgICAgICAgdGhpcy51dGlscyA9IHV0aWxzXG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEhvbWVNb2RlbCB7XG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgICB0aGlzLnVybCA9IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XG4gICAgfVxuICAgIC8vIGdldFNlcnZlckl0ZW0gKCkge1xuICAgIC8vICAgICByZXR1cm4gZmV0Y2godGhpcy51cmwpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKTtcbiAgICAvLyAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGEgbG9hZGVkXCIpO1xuICAgIC8vICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAvLyAgICAgfSlcbiAgICAvLyB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgSG9tZVZpZXcge1xuICAgIGNvbnN0cnVjdG9yICgpIHtcbiAgICAgICAgdGhpcy5kb21FbGVtZW50cyA9IHtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2ZpbGVDb250cm9sbGVyIHsgICBcbiAgICBjb250cm9sbGVyIChtb2RlbCwgdmlldywgb2JzZXJ2ZXIsIHV0aWxzKXtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICAgICAgICB0aGlzLnZpZXcgPSB2aWV3O1xuICAgICAgICB0aGlzLm9ic2VydmUgPSBvYnNlcnZlcjtcbiAgICAgICAgdGhpcy51dGlscyA9IHV0aWxzXG4gICAgfVxuICAgIGJpbmRFdmVudHMoKSB7fVxuICAgIGZpbGxJbmZvRmllbGRzKCkge31cbiAgICBpbml0KCkge31cbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBHYWxlcnlNb2RlbCB7XG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgICB0aGlzLnVybCA9IFwiaHR0cDovL2xvY2FsaG9zdDozMDAwXCI7XG4gICAgfVxuICAgIC8vIGdldFNlcnZlckl0ZW0gKCkge1xuICAgIC8vICAgICByZXR1cm4gZmV0Y2godGhpcy51cmwpLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKTtcbiAgICAvLyAgICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZyhcIkRhdGEgbG9hZGVkXCIpO1xuICAgIC8vICAgICAgICAgcmV0dXJuIGRhdGFcbiAgICAvLyAgICAgfSlcbiAgICAvLyB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvZmlsZVZpZXcge1xuICAgIGNvbnN0cnVjdG9yICgpIHtcbiAgICAgICAgdGhpcy5kb21FbGVtZW50cyA9IHtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfVxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIExvZ2luQ29udHJvbGxlciB7ICAgXG4gICAgY29udHJvbGxlciAobW9kZWwsIHZpZXcsIG9ic2VydmVyLCB1dGlscykge1xuICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgICAgIHRoaXMudmlldyA9IHZpZXc7XG4gICAgICAgIHRoaXMub2JzZXJ2ZSA9IG9ic2VydmVyO1xuICAgICAgICB0aGlzLnV0aWxzID0gdXRpbHM7XG4gICAgfVxuXG4gICAgaW5pdExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy52aWV3LmRvbUVsZW1lbnRzLmxvZ0luLmFkZEV2ZW50TGlzdGVuZXJzKFwiY2xpY2tcIiwgdGhpcy5sb2dJbkhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMudmlldy5kb21FbGVtZW50cy5sb2dPdXQuYWRkRXZlbnRMaXN0ZW5lcnMoXCJjbGlja1wiLCB0aGlzLmxvZ091dEhhbmRsZXIuYmluZCh0aGlzKSk7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiYWxlcnRcIik7XG4gICAgfVxuICAgIGxvZ0luSGFuZGxlcihldmVudCkge1xuXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgY29uc29sZS5sb2coXCJoZWxsb1wiKTtcbiAgICAgICAgbGV0IGNyZWRlbnRpYWxzID0gdGhpcy52aWV3LmdldENyYWRlbnRpYWxzKCk7XG4gICAgICAgIGlmICh0aGlzLm1vZGVsLnZhbGlkYXRlKGNyZWRlbnRpYWxzKSkge1xuICAgICAgICAgICAgdGhpcy5tb2RlbC5sb2dpbihjcmVkZW50aWFscykudGhlbihcbiAgICAgICAgICAgICAgICBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEubG9naW5TdGF0dXMpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52aWV3LmhpZGVNc2coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmlldy5zaG93TGlua3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXRpbHMubmF2aWdhdGVUbyhcImdhbGxlcnlcIik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZpZXcuc2hvd01zZyh0aGlzLm1vZGVsLmdldEVycm9yTXNnKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMudmlldy5zaG93TXNnKHRoaXMubW9kZWwuZ2V0RXJyb3JNc2coKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBsb2dvdXRIYW5kbGVyKCkge1xuICAgICAgICB0aGlzLnZpZXcuaGlkZUxpbmtzKCk7XG4gICAgICAgIHRoaXMubW9kZWwubG9nb3V0KCk7XG4gICAgICAgIHRoaXMudXRpbHMubmF2aWdhdGVUbyhcIlwiKTtcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTG9naW5Nb2RlbCB7XG4gICAgY29uc3RydWN0b3IgKCkge1xuICAgICAgICB0aGlzLmxvZ2luVXJsID0gXCJodHRwOi8vbG9jYWxob3N0OjMwMDAvbG9naW5cIjtcbiAgICAgICAgdGhpcy5lbWFpbFBhdHRlcm4gPSAvXlxcdytAXFx3K1xcLlxcd3syLDR9JC9pO1xuICAgICAgICB0aGlzLnBhc3N3b3JkUGF0dGVybiA9IC9eW2EtekEtWjAtOV17OCwzMH0kLztcbiAgICAgICAgdGhpcy5lcnJvck1zZyA9IG51bGw7XG4gICAgICAgIHRoaXMuZXJyb3JNc2dNYXAgPSB7XG4gICAgICAgICAgICBcImVtcHR5XCIgICAgIDogJ9Cf0L7QttCw0LvRg9C50YHRgtCwINC30LDQv9C+0LvQvdC40YLQtSDQv9C+0LvRjyDQu9C+0LPQuNC9INC4INC/0LDRgNC+0LvRjCcsXG4gICAgICAgICAgICBcImxvZ2luRXJyb3JcIjogJ9Cb0L7Qs9C40L0g0LLQstC10LTQtdC9INC90LXQstC10YDQvdC+LiDQotC+0LvRjNC60L4g0LvQsNGC0LjQvdGB0LrQuNC1INCx0YPQutCy0YsuJyxcbiAgICAgICAgICAgIFwicGFzc0Vycm9yXCIgOiAn0J/QsNGA0L7Qu9GMINCy0LLQtdC00LXQvSDQvdC10LLQtdGA0L3Qvi4g0KLQvtC70YzQuiDQu9Cw0YLQuNC90YHQutC40LUg0LHRg9C60LLRiywg0YbQuNGE0YDRiy4g0JTQu9C40L3QsCDQvdC1INC80LXQvdC10LUgOCDRgdC40LzQstC+0LvQvtCyJyxcbiAgICAgICAgICAgIFwibWlzc21hdGNoXCIgOiAn0J3QtdC/0YDQsNCy0LjQu9GM0L3Ri9C1INC70L7Qs9C40L0g0LjQu9C4INC/0LDRgNC+0LvRjC4nXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgdmFsaWRhdGUoY3JhZGVudGlhbHMpIHtcbiAgICAgICAgcmV0dXJuIGlzRW1wdHkoY3JhZGVudGlhbHMpXG4gICAgICAgICAgICAmJiBpc0VtYWlsQXNzZXJ0UGF0dGVybihjcmFkZW50aWFscylcbiAgICAgICAgICAgICYmIGlzUGFzc3dvcmRBc3NlcnRQYXR0ZXJuKGNyYWRlbnRpYWxzKVxuICAgIH1cblxuICAgIGxvZ2luKGNyZWRlbnRpYWxzKSB7XG4gICAgICAgIGxldCBvcHRpb25zID0ge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNyZWRlbnRpYWxzKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5sb2dpblVybCwgb3B0aW9ucylcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbmNlID0+IHJlc3BvbmNlLmpzb24oKSlcbiAgICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLmxvZ2luU3RhdHVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjcmVkZW50aWFscycsIEpTT04uc3RyaW5naWZ5KGNyZWRlbnRpYWxzKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRFcnJvck1zZyhcIm1pc3NtYXRjaFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRFcnJvck1zZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JNc2c7XG4gICAgfVxuXG4gICAgc2V0RXJyb3JNc2coa2V5KXtcbiAgICAgICAgdGhpcy5lcnJvck1zZyA9IHRoaXMuZXJyb3JNc2dNYXBba2V5XTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlzRW1wdHkoY3JlZGVudGlhbHMpIHtcbiAgICAgICAgcmV0dXJuIChjcmVkZW50aWFscy5sb2dpbiAmJiBjcmVkZW50aWFscy5wYXNzd29yZCkgfHwgdGhpcy5zZXRFcnJvck1zZyhcImVtcHR5XCIpO1xuICAgIH1cblxuICAgIGlzRW1haWxBc3NlcnRQYXR0ZXJuKGNyZWRlbnRpYWxzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVtYWlsUGF0dGVybi50ZXN0KGNyZWRlbnRpYWxzLmxvZ2luKSB8fCB0aGlzLnNldEVycm9yTXNnKFwibG9naW5FcnJvclwiKVxuICAgIH1cbiAgICBcbiAgICBpc1Bhc3N3b3JkQXNzZXJ0UGF0dGVybihjcmVkZW50aWFscykge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXNzd29yZFBhdHRlcm4udGVzdChjcmVkZW50aWFscy5wYXNzd29yZCkgfHwgdGhpcy5zZXRFcnJvck1zZyhcInBhc3NFcnJvclwiKVxuICAgIH1cbiAgICBcbiAgICBsb2dvdXQoKXtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2NyZWRlbnRpYWxzJyk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTG9naW5WaWV3IHtcbiAgICBjb25zdHJ1Y3RvciAoKSB7XG4gICAgICAgIHRoaXMuZG9tRWxlbWVudHMgPSB7XG4gICAgICAgICAgICBsb2dJbkJ0biA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbG9nLWluLWJ0blwiKSxcbiAgICAgICAgICAgIGxvZ091dEJ0biA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbG9nLW91dC1idG5cIiksXG5cbiAgICAgICAgICAgIGxvZ0luIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbnB1dEVtYWlsXCIpLFxuICAgICAgICAgICAgcGFzc3dvcmQgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2lucHV0UGFzc3dvcmRcIilcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5saW5rc0VsZW1lbnQgPSB7XG4gICAgICAgICAgICBob21lIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5ob21lLXN0YXRlXCIpLFxuICAgICAgICAgICAgZ2FsbGVyeSA6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeS1zdGF0ZVwiKSxcbiAgICAgICAgICAgIHByb2ZpbGUgOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGUtc3RhdGVcIilcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBzaG93TXNnKG1zZykge1xuICAgICAgICBpZiAobXNnKSB7XG4gICAgICAgICAgICB0aGlzLmRvbUVsZW1lbnRzLmFsZXJ0LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpO1xuICAgICAgICAgICAgdGhpcy5kb21FbGVtZW50cy5hbGVydC5pbm5lckhUTUwgPSBtc2c7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoaWRlTXNnKCkge1xuICAgICAgICB0aGlzLmRvbUVsZW1lbnRzLmFsZXJ0LmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpO1xuICAgIH1cblxuICAgIHNob3dMaW5rcygpIHtcbiAgICAgICAgdGhpcy5saW5rc0VsZW1lbnRzLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRlXCIpKTtcbiAgICB9XG5cbiAgICBoaWRlTGlua3MoKSB7XG4gICAgICAgIGhpcy5saW5rc0VsZW1lbnRzLmZvckVhY2goaXRlbSA9PiBpdGVtLmNsYXNzTGlzdC5hZGQoXCJoaWRlXCIpKTtcbiAgICB9XG5cbiAgICBnZXRDcmVkZW50aWFscygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGxvZ2luOiB0aGlzLkRPTUVsZW1lbnRzLmxvZ2luLnZhbHVlLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMuRE9NRWxlbWVudHMucGFzc3dvcmQudmFsdWVcbiAgICAgICAgfVxuICAgIH1cbn0iXX0=
